<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Candid Labs Sales Data - Revenue pipeline, margins, account health, and deck metrics.">
  <title>Sales Data - Candidlabs</title>
  <link rel="stylesheet" href="../styles.css">
  <link rel="stylesheet" href="../projects/projects.css">
  <link rel="stylesheet" href="sales.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>
<body data-auth-require="true">
  <!-- Navigation -->
  <nav class="navbar" role="navigation" aria-label="Main navigation">
    <div class="container navbar-container">
      <a href="../index.html" class="logo" aria-label="Candidlabs home">candidlabs</a>

      <ul class="nav-menu" role="menubar">
        <li role="none" class="nav-dropdown">
          <button class="nav-link nav-dropdown-trigger active" type="button" aria-expanded="false" aria-haspopup="true">Sales ▾</button>
          <ul class="nav-dropdown-menu">
            <li><a href="../crm/index.html" class="nav-dropdown-item">CRM</a></li>
            <li><a href="../prospecting/index.html" class="nav-dropdown-item">Prospecting</a></li>
            <li><a href="../agreements/index.html" class="nav-dropdown-item">Agreements</a></li>
            <li><a href="../sales/index.html" class="nav-dropdown-item">Sales Data</a></li>
          </ul>
        </li>
        <li role="none" class="nav-dropdown" data-auth-role="partner">
          <button class="nav-link nav-dropdown-trigger" type="button" aria-expanded="false" aria-haspopup="true">Workspace ▾</button>
          <ul class="nav-dropdown-menu">
            <li><a href="../projects/index.html" class="nav-dropdown-item">Projects</a></li>
            <li><a href="../rnd/index.html" class="nav-dropdown-item">R&D</a></li>
          </ul>
        </li>
        <li role="none"><a href="../reports.html" class="nav-link" role="menuitem">Reports</a></li>
        <li role="none" class="nav-dropdown">
              <button class="nav-link nav-dropdown-trigger" type="button" aria-expanded="false" aria-haspopup="true">Tools ▾</button>
              <ul class="nav-dropdown-menu">
                <li><a href="https://docs.google.com/forms/d/18dshhMSz7csbJBbeLg_fba6SAJMG5uyd3DnkW59rVSw/viewform" class="nav-dropdown-item" target="_blank" rel="noopener">KAA Form</a></li>
                <li><a href="https://docs.google.com/spreadsheets/d/19kDef25LdbvPssTkMusFGu8FmNbj2rWuF7NNF9SBSvs/edit" class="nav-dropdown-item" target="_blank" rel="noopener">Quote Generator</a></li>
                <li><a href="https://xero.me" class="nav-dropdown-item" target="_blank" rel="noopener">Submit Expenses</a></li>
              </ul>
            </li>
      </ul>

      <div class="nav-actions">
        <button id="theme-toggle" class="theme-toggle" type="button" aria-label="Switch to dark mode">
          <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
          <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
        </button>

        <a href="../login.html" class="btn btn-primary btn-login" aria-label="Login">Login</a>

        <button id="mobile-menu-toggle" class="mobile-menu-toggle" type="button" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="mobile-menu">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="mobile-menu" role="menu" aria-label="Mobile navigation">
      <ul>
        <li class="mobile-menu-label">Sales</li>
        <li><a href="../crm/index.html" role="menuitem">CRM</a></li>
        <li><a href="../prospecting/index.html" role="menuitem">Prospecting</a></li>
        <li><a href="../agreements/index.html" role="menuitem">Agreements</a></li>
        <li><a href="../sales/index.html" role="menuitem">Sales Data</a></li>
        <li class="mobile-menu-label" data-auth-role="partner">Workspace</li>
        <li data-auth-role="partner"><a href="../projects/index.html" role="menuitem">Projects</a></li>
        <li data-auth-role="partner"><a href="../rnd/index.html" role="menuitem">R&D</a></li>
        <li><a href="../reports.html" role="menuitem">Reports</a></li>
        <li><a href="../login.html" role="menuitem">Login</a></li>
      </ul>
    </div>
  </nav>

  <main>
    <!-- Page Header -->
    <header class="page-header">
      <div class="container">
        <h1 class="page-title">Sales Data</h1>
        <p class="page-description">Revenue pipeline, margins, account health, and monthly deck metrics</p>
      </div>
    </header>

    <!-- Tool Layout: Sidebar + Content -->
    <section class="section" aria-label="Sales Data Tool">
      <div class="container">
        <div class="tool-layout">

          <!-- Sidebar -->
          <aside class="tool-sidebar" aria-label="Sales navigation">
            <div class="sidebar-section">
              <div class="sidebar-label">Sales Modules</div>
              <button class="tool-btn active" data-tool="overview" onclick="slsSwitchTool('overview')">Overview</button>
              <button class="tool-btn" data-tool="revenue" onclick="slsSwitchTool('revenue')">Revenue</button>
              <button class="tool-btn" data-tool="accounts" onclick="slsSwitchTool('accounts')">Accounts</button>
              <button class="tool-btn" data-tool="deck" onclick="slsSwitchTool('deck')">Deck Metrics</button>
            </div>
            <div class="sidebar-section">
              <div class="sidebar-label">Actions</div>
              <button class="tool-btn sls-action-btn" onclick="slsRunPipeline()">Run Pipeline</button>
            </div>
          </aside>

          <!-- Content Area -->
          <div class="tool-content">

            <!-- OVERVIEW PANEL -->
            <div class="tool-panel active" id="tool-overview">
              <div class="tool-panel-header">
                <h2>Sales Overview</h2>
                <p>Revenue pipeline summary</p>
              </div>

              <div class="pm-stats">
                <div class="pm-stat-card">
                  <div class="pm-stat-number" id="stat-sls-total-rev">-</div>
                  <div class="pm-stat-label">Total Revenue (IDR)</div>
                </div>
                <div class="pm-stat-card">
                  <div class="pm-stat-number" id="stat-sls-txn-count">0</div>
                  <div class="pm-stat-label">Transactions</div>
                </div>
                <div class="pm-stat-card">
                  <div class="pm-stat-number" id="stat-sls-active-accts">0</div>
                  <div class="pm-stat-label">Active Accounts</div>
                </div>
                <div class="pm-stat-card">
                  <div class="pm-stat-number" id="stat-sls-deck-months">0</div>
                  <div class="pm-stat-label">Deck Months</div>
                </div>
              </div>

              <div id="sls-overview-details"></div>
            </div>

            <!-- REVENUE PANEL -->
            <div class="tool-panel" id="tool-revenue">
              <div class="tool-panel-header">
                <h2>Revenue Transactions</h2>
                <p>Imported receivables from Xero</p>
              </div>

              <div class="pm-action-bar">
                <input type="text" class="pm-search" id="sls-rev-search" placeholder="Search venue, SKU, distributor..." aria-label="Search revenue" oninput="slsRenderRevenue()">
                <button class="btn-add" onclick="slsImportReceivables()">Import Receivables</button>
              </div>

              <div class="pm-table-container">
                <table class="pm-table">
                  <thead>
                    <tr>
                      <th><button class="pm-sort-btn sls-rev-sort" data-col="invoice_date" onclick="slsRevSort('invoice_date')">Date<span class="sort-arrow"></span></button></th>
                      <th>Invoice #</th>
                      <th><button class="pm-sort-btn sls-rev-sort" data-col="venue_name" onclick="slsRevSort('venue_name')">Venue<span class="sort-arrow"></span></button></th>
                      <th>SKU</th>
                      <th>Qty (cases)</th>
                      <th><button class="pm-sort-btn sls-rev-sort" data-col="revenue_idr" onclick="slsRevSort('revenue_idr')">Revenue (IDR)<span class="sort-arrow"></span></button></th>
                      <th>Channel</th>
                    </tr>
                  </thead>
                  <tbody id="sls-rev-tbody"></tbody>
                </table>
              </div>
              <div class="sls-pagination" id="sls-rev-pagination"></div>
            </div>

            <!-- ACCOUNTS PANEL -->
            <div class="tool-panel" id="tool-accounts">
              <div class="tool-panel-header">
                <h2>Account Health</h2>
                <p>Account status and mapping</p>
              </div>

              <div class="pm-filter-tabs">
                <button class="pm-filter-tab active" data-status="all" onclick="slsAcctFilter('all')">All</button>
                <button class="pm-filter-tab" data-status="Active" onclick="slsAcctFilter('Active')">Active</button>
                <button class="pm-filter-tab" data-status="At Risk" onclick="slsAcctFilter('At Risk')">At Risk</button>
                <button class="pm-filter-tab" data-status="Dormant" onclick="slsAcctFilter('Dormant')">Dormant</button>
                <button class="pm-filter-tab" data-status="New" onclick="slsAcctFilter('New')">New</button>
              </div>

              <div class="pm-action-bar">
                <input type="text" class="pm-search" id="sls-acct-search" placeholder="Search accounts..." aria-label="Search accounts" oninput="slsRenderAccounts()">
                <div style="display:flex;gap:8px;">
                  <button class="btn-add" onclick="slsRebuildAccountStatus()">Rebuild Status</button>
                  <button class="btn-add" style="background:var(--text-secondary);" onclick="slsSyncMapping()">Sync Mapping</button>
                </div>
              </div>

              <div class="pm-table-container">
                <table class="pm-table">
                  <thead>
                    <tr>
                      <th>Venue</th>
                      <th>Account ID</th>
                      <th>Status</th>
                      <th>First Order</th>
                      <th>Latest Order</th>
                      <th>Days Since</th>
                    </tr>
                  </thead>
                  <tbody id="sls-acct-tbody"></tbody>
                </table>
              </div>
            </div>

            <!-- DECK METRICS PANEL -->
            <div class="tool-panel" id="tool-deck">
              <div class="tool-panel-header">
                <h2>Deck Metrics</h2>
                <p>Monthly KPI snapshots for board decks</p>
              </div>

              <div class="pm-action-bar">
                <input type="text" class="pm-search" id="sls-deck-search" placeholder="Search month..." aria-label="Search deck" oninput="slsRenderDeck()">
                <button class="btn-add" onclick="slsRefreshDeckMetrics()">Refresh Metrics</button>
              </div>

              <div class="pm-table-container">
                <table class="pm-table">
                  <thead>
                    <tr>
                      <th>Month</th>
                      <th>Revenue (IDR)</th>
                      <th>Gross Margin</th>
                      <th>vs Prev</th>
                      <th>DQ</th>
                      <th>Headline</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="sls-deck-tbody"></tbody>
                </table>
              </div>
            </div>

          </div><!-- /tool-content -->
        </div><!-- /tool-layout -->
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <p class="footer-content">&copy; 2026 Candidlabs - Internal Use Only</p>
    </div>
  </footer>

  <script src="../auth.js"></script>
  <script src="../data-adapter.js"></script>
  <script src="../script.js"></script>
  <script src="sales.js"></script>
</body>
</html>
